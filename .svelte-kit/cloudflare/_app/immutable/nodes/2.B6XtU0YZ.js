import"../chunks/CWj6FrbW.js";import{i as bt}from"../chunks/BpldQMAd.js";import{o as gt,a as Mt}from"../chunks/BBvWJmYc.js";import{p as ht,s as g,m as H,f as h,g as b,d as i,r as o,n as E,t as W,B as l,i as t,k as J,b as u,c as xt,aU as ut,aV as St,h as It,$ as jt,j as Nt,a as pt,aS as Ct,e as Lt}from"../chunks/Cslclzbr.js";import{i as F}from"../chunks/D4P07oHo.js";import{e as Et,i as At}from"../chunks/CRhN_H0k.js";import{s as tt}from"../chunks/0uQcGVMJ.js";import{s as ft}from"../chunks/DEvKvmVM.js";import{d as B}from"../chunks/DkinEwNE.js";import{c as Yt,g as zt,s as nt}from"../chunks/BMfMfNjS.js";import{p as Gt}from"../chunks/C42AZTO_.js";var _t={exports:{}};(function(Q,R){(function(w,S){Q.exports=S()})(Yt,function(){return function(w,S,a){w=w||{};var d=S.prototype,D={future:"in %s",past:"%s ago",s:"a few seconds",m:"a minute",mm:"%d minutes",h:"an hour",hh:"%d hours",d:"a day",dd:"%d days",M:"a month",MM:"%d months",y:"a year",yy:"%d years"};function I(m,x,k,j){return d.fromToBase(m,x,k,j)}a.en.relativeTime=D,d.fromToBase=function(m,x,k,j,P){for(var U,N,Y,K=k.$locale().relativeTime||D,z=w.thresholds||[{l:"s",r:44,d:"second"},{l:"m",r:89},{l:"mm",r:44,d:"minute"},{l:"h",r:89},{l:"hh",r:21,d:"hour"},{l:"d",r:35},{l:"dd",r:25,d:"day"},{l:"M",r:45},{l:"MM",r:10,d:"month"},{l:"y",r:17},{l:"yy",d:"year"}],X=z.length,G=0;G<X;G+=1){var e=z[G];e.d&&(U=j?a(m).diff(k,e.d,!0):k.diff(m,e.d,!0));var r=(w.rounding||Math.round)(Math.abs(U));if(Y=U>0,r<=e.r||!e.r){r<=1&&G>0&&(e=z[G-1]);var n=K[e.l];P&&(r=P(""+r)),N=typeof n=="string"?n.replace("%d",r):n(r,x,e.l,Y);break}}if(x)return N;var s=Y?K.future:K.past;return typeof s=="function"?s(N):s.replace("%s",N)},d.to=function(m,x){return I(m,x,this,!0)},d.from=function(m,x){return I(m,x,this)};var A=function(m){return m.$u?a.utc():a()};d.toNow=function(m){return this.to(A(this),m)},d.fromNow=function(m){return this.from(A(this),m)}}})})(_t);var Ot=_t.exports;const Ft=zt(Ot);var Ht=h('<div class="relative bg-gradient-to-br from-white/95 to-white/85 backdrop-blur-xl rounded-3xl p-6 shadow-2xl border border-white/50 overflow-hidden"><div class="text-center mb-4"><h3 class="text-2xl font-bold bg-gradient-to-r from-rose-600 to-pink-600 bg-clip-text text-transparent mb-2">⏰ Thời Gian Yêu Nhau</h3> <p class="text-gray-600 font-medium">Từ ngày bắt đầu đến hiện tại</p></div> <div class="flex items-center justify-center space-x-3 mb-4"><div class="text-center bg-gradient-to-br from-rose-50 to-pink-50 rounded-2xl p-4 min-w-[80px] shadow-lg border border-rose-100/50"><span class="text-xl font-bold bg-gradient-to-r from-rose-600 to-pink-600 bg-clip-text text-transparent block transition-all duration-300"> </span> <span class="text-xs font-semibold text-gray-600 mt-1">Ngày</span></div> <div class="text-lg font-bold text-rose-400 animate-pulse mx-1">:</div> <div class="text-center bg-gradient-to-br from-rose-50 to-pink-50 rounded-2xl p-4 min-w-[70px] shadow-lg border border-rose-100/50"><span class="text-xl font-bold bg-gradient-to-r from-rose-600 to-pink-600 bg-clip-text text-transparent block transition-all duration-300"> </span> <span class="text-xs font-semibold text-gray-600 mt-1">Giờ</span></div> <div class="text-lg font-bold text-rose-400 animate-pulse mx-1">:</div> <div class="text-center bg-gradient-to-br from-rose-50 to-pink-50 rounded-2xl p-4 min-w-[70px] shadow-lg border border-rose-100/50"><span class="text-xl font-bold bg-gradient-to-r from-rose-600 to-pink-600 bg-clip-text text-transparent block transition-all duration-300"> </span> <span class="text-xs font-semibold text-gray-600 mt-1">Phút</span></div> <div class="text-lg font-bold text-rose-400 animate-pulse mx-1">:</div> <div class="text-center bg-gradient-to-br from-rose-50 to-pink-50 rounded-2xl p-4 min-w-[70px] shadow-lg border border-rose-100/50"><span class="text-xl font-bold bg-gradient-to-r from-rose-600 to-pink-600 bg-clip-text text-transparent block transition-all duration-300"> </span> <span class="text-xs font-semibold text-gray-600 mt-1">Giây</span></div></div> <div class="absolute inset-0 pointer-events-none"><div class="absolute top-4 left-4 text-lg opacity-15 animate-bounce" style="animation-duration: 2s; animation-delay: 0s;">💖</div> <div class="absolute top-4 right-4 text-lg opacity-15 animate-bounce" style="animation-duration: 2.5s; animation-delay: 0.5s;">💕</div> <div class="absolute bottom-4 left-1/2 transform -translate-x-1/2 text-lg opacity-15 animate-bounce" style="animation-duration: 3s; animation-delay: 1s;">💗</div> <div class="absolute top-1/2 left-2 text-lg opacity-15 animate-pulse" style="animation-duration: 2.2s; animation-delay: 1.5s;">💝</div> <div class="absolute top-1/2 right-2 text-lg opacity-15 animate-pulse" style="animation-duration: 2.8s; animation-delay: 0.8s;">💘</div></div></div>');function lt(Q,R){ht(R,!1);let w=Gt(R,"startDate",8),S=H(0),a=H(0),d=H(0),D=H(0),I;gt(()=>{w()&&m()}),Mt(()=>{I&&clearInterval(I)});function A(s){if(s.includes("/")){const p=s.split("/");if(p.length===3){const f=parseInt(p[0]),_=parseInt(p[1])-1,C=parseInt(p[2]);return new Date(C,_,f)}}return new Date(s)}function m(){console.log("Start date received:",w());const s=A(w());console.log("Parsed start date:",s),console.log("Current date:",new Date),I=setInterval(()=>{const C=new Date,Z=A(w()),L=C.getTime()-Z.getTime();console.log("Time difference in ms:",L),console.log("Time difference in days:",Math.floor(L/(1e3*60*60*24)));const O=Math.floor(L/(1e3*60*60*24)),v=Math.floor(L%(1e3*60*60*24)/(1e3*60*60)),q=Math.floor(L%(1e3*60*60)/(1e3*60)),V=Math.floor(L%(1e3*60)/1e3);g(S,O),g(a,v),g(d,q),g(D,V)},1e3);const p=new Date,f=A(w()),_=p.getTime()-f.getTime();g(S,Math.floor(_/(1e3*60*60*24))),g(a,Math.floor(_%(1e3*60*60*24)/(1e3*60*60))),g(d,Math.floor(_%(1e3*60*60)/(1e3*60))),g(D,Math.floor(_%(1e3*60)/1e3))}bt();var x=Ht(),k=b(i(x),2),j=i(k),P=i(j),U=i(P,!0);o(P),E(2),o(j);var N=b(j,4),Y=i(N),K=i(Y,!0);o(Y),E(2),o(N);var z=b(N,4),X=i(z),G=i(X,!0);o(X),E(2),o(z);var e=b(z,4),r=i(e),n=i(r,!0);o(r),E(2),o(e),o(k),E(2),o(x),W((s,p,f,_)=>{J(U,s),J(K,p),J(G,f),J(n,_)},[()=>(t(S),l(()=>t(S).toString().padStart(3,"0"))),()=>(t(a),l(()=>t(a).toString().padStart(2,"0"))),()=>(t(d),l(()=>t(d).toString().padStart(2,"0"))),()=>(t(D),l(()=>t(D).toString().padStart(2,"0")))]),u(Q,x),xt()}var Kt=h('<meta name="description" content="Lưu giữ những khoảnh khắc đẹp nhất của tình yêu"/>'),Vt=h('<img class="w-20 h-20 rounded-full object-cover border-4 border-white shadow-2xl group-hover:scale-110 transition-transform duration-300"/>'),Bt=h('<div class="w-20 h-20 rounded-full bg-gradient-to-br from-rose-200 to-pink-300 flex items-center justify-center text-3xl border-4 border-white shadow-2xl group-hover:scale-110 transition-transform duration-300">👤</div>'),Jt=h('<img class="w-20 h-20 rounded-full object-cover border-4 border-white shadow-2xl group-hover:scale-110 transition-transform duration-300"/>'),Pt=h('<div class="w-20 h-20 rounded-full bg-gradient-to-br from-purple-200 to-fuchsia-300 flex items-center justify-center text-3xl border-4 border-white shadow-2xl group-hover:scale-110 transition-transform duration-300">👤</div>'),Ut=h('<div class="text-center mb-12"><div class="flex justify-center items-center mb-8 relative"><div class="relative group"><!> <div class="absolute -inset-2 bg-gradient-to-r from-rose-400 to-pink-500 rounded-full opacity-20 group-hover:opacity-40 transition-opacity duration-300 blur-sm"></div></div> <div class="mx-6 text-5xl animate-pulse hover:animate-bounce cursor-pointer">💕</div> <div class="relative group"><!> <div class="absolute -inset-2 bg-gradient-to-r from-purple-400 to-fuchsia-500 rounded-full opacity-20 group-hover:opacity-40 transition-opacity duration-300 blur-sm"></div></div></div> <h1 class="text-4xl font-bold bg-gradient-to-r from-rose-600 via-pink-600 to-fuchsia-600 bg-clip-text text-transparent mb-4 tracking-wide"> </h1> <!></div>'),Wt=h('<div class="text-center mb-12"><div class="text-8xl mb-6 animate-pulse">💖</div> <h1 class="text-5xl font-bold bg-gradient-to-r from-rose-600 via-pink-600 to-fuchsia-600 bg-clip-text text-transparent mb-4 tracking-wide">Dòng Thời Gian Tình Yêu</h1> <p class="text-gray-700 text-xl mb-8 font-medium">Lưu giữ những khoảnh khắc đẹp nhất của tình yêu</p> <div class="mb-8"><!></div> <a href="/settings" class="inline-block bg-gradient-to-r from-rose-500 to-pink-500 hover:from-rose-600 hover:to-pink-600 text-white px-8 py-4 rounded-3xl font-semibold text-lg transition-all duration-300 shadow-xl hover:shadow-2xl transform hover:scale-105">Thiết Lập Hồ Sơ 💕</a></div>'),Xt=h('<div class="text-center py-16 relative z-10"><div class="animate-spin rounded-full h-12 w-12 border-b-2 border-rose-500 mx-auto mb-4"></div> <h3 class="text-xl font-bold text-gray-700 mb-2">Đang tải kỷ niệm...</h3> <p class="text-gray-600">Vui lòng chờ trong giây lát</p></div>'),qt=h('<img alt="Kỷ niệm" class="w-14 h-14 object-cover rounded-full"/> <span class="text-2xl hidden">📚</span>',1),Qt=h('<span class="text-2xl">📚</span>'),Rt=h('<p class="text-gray-700 text-base leading-relaxed font-medium mt-3 text-center"> </p>'),Zt=h('<div><div class="relative z-20 flex-shrink-0 w-20 h-20 bg-gradient-to-br from-white to-rose-50 rounded-full border-4 border-rose-300 flex items-center justify-center shadow-2xl group-hover:scale-110 transition-all duration-300"><!> <div class="absolute -inset-2 bg-gradient-to-r from-rose-400 to-pink-500 rounded-full opacity-0 group-hover:opacity-30 transition-opacity duration-300 blur-sm"></div></div> <div><div class="bg-gradient-to-br from-rose-50/80 to-pink-50/80 backdrop-blur-sm rounded-3xl p-6 shadow-xl border border-rose-100/50 group-hover:shadow-2xl group-hover:scale-105 transition-all duration-300 relative overflow-hidden"><div class="absolute inset-0 bg-gradient-to-br from-white/30 to-transparent"></div> <div class="relative z-10"><div class="text-center"><h3 class="font-bold text-gray-800 text-lg mb-2"> </h3> <span class="text-sm text-gray-500 bg-white/60 px-3 py-1 rounded-full font-medium block"> </span></div> <!></div></div></div></div>'),$t=h('<div class="text-center mt-10"><a href="/albums" class="inline-block bg-gradient-to-r from-rose-500 to-pink-500 hover:from-rose-600 hover:to-pink-600 text-white px-8 py-3 rounded-2xl font-semibold transition-all duration-300 shadow-lg hover:shadow-xl transform hover:scale-105">Xem Tất Cả Kỷ Niệm 💕</a></div>'),te=h('<div class="relative z-10"><div class="absolute left-10 top-0 bottom-0 w-2 bg-gradient-to-b from-rose-300 via-pink-400 to-fuchsia-300 rounded-full shadow-lg"></div> <div class="space-y-10"></div> <!></div>'),ee=h('<div class="text-center py-16 relative z-10"><div class="text-8xl mb-6 animate-bounce">📸</div> <h3 class="text-2xl font-bold text-gray-700 mb-4">Chưa có kỷ niệm nào</h3> <p class="text-gray-600 mb-8 text-lg font-medium">Hãy bắt đầu tạo ra những kỷ niệm đẹp cùng nhau!</p> <div class="flex justify-center space-x-4"><a href="/upload" class="bg-gradient-to-r from-rose-500 to-pink-500 hover:from-rose-600 hover:to-pink-600 text-white px-6 py-3 rounded-xl font-medium text-base transition-all duration-300 shadow-lg hover:shadow-xl transform hover:scale-105">Tải Lên Kỷ Niệm 📸</a> <a href="/albums" class="px-6 py-3 bg-white border-2 border-rose-300 text-rose-600 rounded-xl hover:bg-rose-50 transition-all duration-300 font-medium text-base shadow-lg hover:shadow-xl transform hover:scale-105">Tạo Album Mới 📚</a></div></div>'),ae=h('<div class="min-h-screen bg-gradient-to-br from-rose-50 via-pink-50 to-fuchsia-50 pb-24 relative overflow-hidden"><div class="absolute inset-0 overflow-hidden pointer-events-none"><div class="absolute top-16 left-8 text-5xl opacity-10 animate-pulse">💖</div> <div class="absolute top-32 right-12 text-4xl opacity-15 animate-bounce">💕</div> <div class="absolute bottom-20 left-16 text-6xl opacity-8 animate-pulse">💝</div> <div class="absolute bottom-32 right-8 text-3xl opacity-12 animate-bounce">💗</div> <div class="absolute top-1/2 left-4 text-4xl opacity-10 animate-pulse">🌸</div> <div class="absolute top-1/3 right-6 text-3xl opacity-15 animate-bounce">🌺</div></div> <div class="relative z-10"><div class="relative container mx-auto px-4 py-16"><!></div></div> <div class="container mx-auto px-4 mb-8 -mt-8"><div class="bg-gradient-to-br from-white/95 to-white/85 backdrop-blur-xl rounded-3xl p-8 shadow-2xl border border-white/50 relative overflow-hidden"><div class="absolute inset-0 bg-gradient-to-br from-rose-50/50 to-pink-50/50"></div> <div class="relative z-10 text-center mb-6"><h2 class="text-3xl font-bold bg-gradient-to-r from-rose-600 via-pink-600 to-fuchsia-600 bg-clip-text text-transparent mb-3 flex items-center justify-center"><span class="mr-3 text-4xl animate-pulse">💕</span> Dòng Thời Gian Tình Yêu <span class="ml-3 text-4xl animate-pulse">💕</span></h2> <p class="text-gray-600 text-lg font-medium">Những khoảnh khắc đáng nhớ của chúng ta</p></div> <!></div></div></div>');function pe(Q,R){ht(R,!1);const w=H(),S=H();B.extend(Ft);let a=H({}),d=H([]),D=H(!0);gt(()=>{const e=localStorage.getItem("coupleInfo");e&&g(a,JSON.parse(e)),localStorage.removeItem("uploadedAlbums"),I();const r=nt.channel("memories_changes").on("postgres_changes",{event:"*",schema:"public",table:"memories"},()=>{I()}).subscribe();return()=>{nt.removeChannel(r)}});async function I(){try{g(D,!0),console.log("Loading from Supabase...");const{data:e,error:r}=await nt.from("memories").select(`
					id,
					media_url,
					caption,
					created_at,
					albums (
						id,
						title,
						description
					)
				`).order("created_at",{ascending:!1});if(console.log("Supabase memories response:",{memoriesData:e,memoriesError:r}),r){console.error("Error loading memories:",r),A();return}g(d,[]),console.log("Memories from Supabase:",e),e&&e.length>0&&g(d,e.map(n=>{var s,p;return{id:n.id,media_url:n.media_url,caption:n.caption||"",created_at:n.created_at,albums:{title:((s=n.albums)==null?void 0:s.title)||"Unknown Album",description:((p=n.albums)==null?void 0:p.description)||""}}})),console.log("Memories after processing:",t(d))}catch(e){console.error("Error loading memories:",e),A()}finally{g(D,!1)}}function A(){const e=localStorage.getItem("uploadedAlbums");if(e){const r=JSON.parse(e),n=r.filter(s=>s.media_url?s.media_url.startsWith("data:")||s.media_url.startsWith("http"):!0);g(d,n.map((s,p)=>{var f;return{id:s.id||p,media_url:s.media_url||null,caption:s.caption||"",created_at:s.created_at||new Date().toISOString(),albums:{title:((f=s.albums)==null?void 0:f.title)||"New Album"}}})),n.length!==r.length&&localStorage.setItem("uploadedAlbums",JSON.stringify(n))}else g(d,[{id:1,media_url:"https://images.unsplash.com/photo-1516589178581-6cd7833ae3b2?w=400",caption:"Our first date",created_at:"2024-01-15",albums:{title:"First Date"}},{id:2,media_url:"https://images.unsplash.com/photo-1518709268805-4e9042af2176?w=400",caption:"Valentine's Day",created_at:"2024-02-14",albums:{title:"Valentine's"}},{id:3,media_url:"https://images.unsplash.com/photo-1517841905240-472988babdf9?w=400",caption:"Summer vacation",created_at:"2024-07-20",albums:{title:"Summer Trip"}}])}async function m(){await I()}typeof window<"u"&&(window.refreshTimeline=m),ut(()=>(t(a),B),()=>{g(w,t(a).startDate?B().diff(B(t(a).startDate),"day"):0)}),ut(()=>(t(a),B),()=>{g(S,t(a).startDate?B(t(a).startDate).fromNow():"")}),St(),bt();var x=ae();It(e=>{var r=Kt();jt.title="Dòng Thời Gian Tình Yêu - Trang Chủ",u(e,r)});var k=b(i(x),2),j=i(k),P=i(j);{var U=e=>{var r=Ut(),n=i(r),s=i(n),p=i(s);{var f=c=>{var y=Vt();W(()=>{tt(y,"src",(t(a),l(()=>t(a).avatar1))),tt(y,"alt",(t(a),l(()=>t(a).partner1)))}),u(c,y)},_=c=>{var y=Bt();u(c,y)};F(p,c=>{t(a),l(()=>t(a).avatar1)?c(f):c(_,!1)})}E(2),o(s);var C=b(s,4),Z=i(C);{var L=c=>{var y=Jt();W(()=>{tt(y,"src",(t(a),l(()=>t(a).avatar2))),tt(y,"alt",(t(a),l(()=>t(a).partner2)))}),u(c,y)},O=c=>{var y=Pt();u(c,y)};F(Z,c=>{t(a),l(()=>t(a).avatar2)?c(L):c(O,!1)})}E(2),o(C),o(n);var v=b(n,2),q=i(v);o(v);var V=b(v,2);{var $=c=>{lt(c,{get startDate(){return t(a),l(()=>t(a).startDate)}})},at=c=>{lt(c,{startDate:"2024-01-01"})};F(V,c=>{t(a),l(()=>t(a).startDate)?c($):c(at,!1)})}o(r),W(()=>J(q,`${t(a),l(()=>t(a).partner1)??""} & ${t(a),l(()=>t(a).partner2)??""}`)),u(e,r)},N=e=>{var r=Wt(),n=b(i(r),6),s=i(n);lt(s,{startDate:"2024-01-01"}),o(n),E(2),o(r),u(e,r)};F(P,e=>{t(a),l(()=>t(a).partner1&&t(a).partner2)?e(U):e(N,!1)})}o(j),o(k);var Y=b(k,2),K=i(Y),z=b(i(K),4);{var X=e=>{var r=Xt();u(e,r)},G=e=>{var r=Nt(),n=pt(r);{var s=f=>{var _=te(),C=b(i(_),2);Et(C,5,()=>(t(d),l(()=>t(d).slice(0,8))),At,(O,v,q)=>{var V=Zt();ft(V,1,`relative flex items-start ${q%2===0?"flex-row":"flex-row-reverse"} group`);var $=i(V),at=i($);{var c=T=>{var M=qt(),et=pt(M);E(2),W(()=>tt(et,"src",(t(v),l(()=>t(v).media_url)))),Lt("error",et,Dt=>{console.log("Image failed to load:",t(v).media_url);const it=Dt.target;if(it instanceof HTMLImageElement){it.style.display="none";const mt=it.nextElementSibling;mt instanceof HTMLElement&&(mt.style.display="block")}}),u(T,M)},y=T=>{var M=Qt();u(T,M)};F(at,T=>{t(v),l(()=>t(v).media_url)?T(c):T(y,!1)})}E(2),o($);var rt=b($,2);ft(rt,1,`flex-1 mx-8 ${q%2===0?"ml-0":"mr-0"} group`);var dt=i(rt),ct=b(i(dt),2),ot=i(ct),st=i(ot),wt=i(st,!0);o(st);var vt=b(st,2),yt=i(vt,!0);o(vt),o(ot);var kt=b(ot,2);{var Tt=T=>{var M=Rt(),et=i(M,!0);o(M),W(()=>J(et,(t(v),l(()=>t(v).caption)))),u(T,M)};F(kt,T=>{t(v),l(()=>t(v).caption)&&T(Tt)})}o(ct),o(dt),o(rt),o(V),W(T=>{J(wt,(t(v),l(()=>{var M;return((M=t(v).albums)==null?void 0:M.title)||"Kỷ niệm"}))),J(yt,T)},[()=>(Ct(B),t(v),l(()=>B(t(v).created_at).format("DD/MM/YYYY")))]),u(O,V)}),o(C);var Z=b(C,2);{var L=O=>{var v=$t();u(O,v)};F(Z,O=>{t(d),l(()=>t(d).length>8)&&O(L)})}o(_),u(f,_)},p=f=>{var _=ee();u(f,_)};F(n,f=>{t(d),l(()=>t(d).length>0)?f(s):f(p,!1)},!0)}u(e,r)};F(z,e=>{t(D)?e(X):e(G,!1)})}o(K),o(Y),o(x),u(Q,x),xt()}export{pe as component};
