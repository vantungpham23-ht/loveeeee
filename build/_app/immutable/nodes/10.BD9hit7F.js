import"../chunks/CWj6FrbW.js";import{i as re}from"../chunks/BpldQMAd.js";import{o as te}from"../chunks/BBvWJmYc.js";import{aj as ae,at as oe,H as ie,a4 as le,au as ne,av as se,a0 as R,am as de,p as ue,f as S,h as ce,t as y,e as A,i as r,b as k,c as pe,$ as fe,g as b,m as g,s as i,d as c,r as d,aw as ve,k as D,a as me,n as be}from"../chunks/Cslclzbr.js";import{i as E}from"../chunks/D4P07oHo.js";import{e as _e,i as ge}from"../chunks/CRhN_H0k.js";import{r as he,s as xe}from"../chunks/0uQcGVMJ.js";import{b as we}from"../chunks/NqDlTKQn.js";import{p as ye}from"../chunks/CWmzcjye.js";import{g as ke,u as Se}from"../chunks/CrxYcAco.js";function C(t,u,p=!1){if(t.multiple){if(u==null)return;if(!le(u))return ne();for(var l of t.options)l.selected=u.includes(I(l));return}for(l of t.options){var f=I(l);if(se(f,u)){l.selected=!0;return}}(!p||u!==void 0)&&(t.selectedIndex=-1)}function Ue(t){var u=new MutationObserver(()=>{C(t,t.__value)});u.observe(t,{childList:!0,subtree:!0,attributes:!0,attributeFilter:["value"]}),ie(()=>{u.disconnect()})}function Ae(t,u,p=u){var l=new WeakSet,f=!0;ae(t,"change",n=>{var m=n?"[selected]":":checked",v;if(t.multiple)v=[].map.call(t.querySelectorAll(m),I);else{var h=t.querySelector(m)??t.querySelector("option:not([disabled])");v=h&&I(h)}p(v),R!==null&&l.add(R)}),oe(()=>{var n=u();if(t===document.activeElement){var m=de??R;if(l.has(m))return}if(C(t,n,f),f&&n===void 0){var v=t.querySelector(":checked");v!==null&&(n=I(v),p(n))}t.__value=n,f=!1}),Ue(t)}function I(t){return"__value"in t?t.__value:t.value}var De=S('<img alt="Preview" class="max-h-64 object-contain mx-auto mb-4 rounded-lg"/> <p class="text-gray-700 font-medium"> </p>',1),Ie=S('<div class="text-6xl mb-4">‚¨ÜÔ∏è</div> <p class="text-gray-700 font-medium mb-2">Drag & drop your photo/video here</p> <p class="text-gray-500 text-sm">or click to browse</p>',1),Oe=S("<option> </option>"),Te=S('<div class="p-3 bg-red-50 border border-red-200 rounded-2xl"><p class="text-red-700 text-sm"> </p></div>'),Fe=S('<div class="p-3 bg-green-50 border border-green-200 rounded-2xl"><p class="text-green-700 text-sm"> </p></div>'),Le=S('<div class="container mx-auto px-4 py-8"><div class="text-center mb-8"><h1 class="text-3xl font-bold text-pink-600 mb-2">üì∏ Upload New Memory</h1> <p class="text-gray-600">Share your special moments with your loved one.</p></div> <div class="max-w-2xl mx-auto bg-white/90 backdrop-blur rounded-3xl shadow-lg p-8"><form class="space-y-6"><div class="border-2 border-dashed border-pink-300 rounded-2xl p-8 text-center cursor-pointer hover:border-pink-400 transition-colors duration-200" role="button" tabindex="0"><input type="file" id="fileInput" class="hidden" accept="image/*,video/*"/> <!></div> <div><label for="albumSelect" class="block text-sm font-medium text-gray-700 mb-2">Select Album</label> <select id="albumSelect" class="w-full px-4 py-3 rounded-2xl border border-gray-200 focus:border-pink-300 focus:ring-2 focus:ring-pink-100 transition-colors duration-200 bg-white/80 backdrop-blur" required></select></div> <div><label for="captionInput" class="block text-sm font-medium text-gray-700 mb-2">Caption (Optional)</label> <input id="captionInput" placeholder="Add a sweet caption..." type="text" class="w-full px-4 py-3 rounded-2xl border border-gray-200 focus:border-pink-300 focus:ring-2 focus:ring-pink-100 transition-colors duration-200 bg-white/80 backdrop-blur"/></div> <!> <!> <button type="submit" class="w-full bg-gradient-to-r from-pink-500 to-purple-500 hover:from-pink-600 hover:to-purple-600 text-white px-6 py-3 rounded-2xl font-medium transition-all duration-200 shadow-lg hover:shadow-xl transform hover:scale-105 disabled:opacity-50 disabled:cursor-not-allowed"> </button></form></div></div>');function Ce(t,u){ue(u,!1);let p=g([]),l=g(""),f=g(""),n=g(null),m=g(""),v=g(!1),h=g(""),_=g("");te(async()=>{try{i(p,await ke()),r(p).length>0&&i(l,r(p)[0].id)}catch(e){console.error("Error loading albums:",e),i(_,"Failed to load albums. Please try again.")}});function H(e){var s;const o=(s=e.target.files)==null?void 0:s[0];o&&(i(n,o),i(m,URL.createObjectURL(o)),i(_,""))}function W(e){var o;e.preventDefault();const a=(o=e.dataTransfer)==null?void 0:o.files[0];a&&(i(n,a),i(m,URL.createObjectURL(a)),i(_,""))}function z(e){e.preventDefault()}async function G(){if(!r(n)||!r(l)){i(_,"Please select a file and an album.");return}i(v,!0),i(h,""),i(_,"");try{await Se(r(n),r(l),r(f)||void 0),i(h,"Upload successful!");const e=new FileReader;e.onload=a=>{var U,B;const o={id:Date.now(),media_url:(U=a.target)==null?void 0:U.result,caption:r(f)||"",created_at:new Date().toISOString(),albums:{title:((B=r(p).find(ee=>ee.id===r(l)))==null?void 0:B.title)||"New Album"}},s=localStorage.getItem("uploadedAlbums"),x=s?JSON.parse(s):[];x.unshift(o),localStorage.setItem("uploadedAlbums",JSON.stringify(x)),typeof window<"u"&&window.refreshTimeline&&setTimeout(()=>{window.refreshTimeline()},1e3)},e.readAsDataURL(r(n)),i(n,null),i(m,""),i(f,""),typeof window<"u"&&window.refreshTimeline&&setTimeout(()=>{window.refreshTimeline()},1e3)}catch(e){console.error("Upload error:",e),i(_,e instanceof Error?e.message:"Failed to upload file.")}finally{i(v,!1)}}re();var O=Le();ce(e=>{fe.title="Upload - Love Timeline"});var j=b(c(O),2),T=c(j),w=c(T),N=c(w),K=b(N,2);{var Q=e=>{var a=De(),o=me(a),s=b(o,2),x=c(s,!0);d(s),y(()=>{var U;xe(o,"src",r(m)),D(x,(U=r(n))==null?void 0:U.name)}),k(e,a)},V=e=>{var a=Ie();be(4),k(e,a)};E(K,e=>{r(m)?e(Q):e(V,!1)})}d(w);var F=b(w,2),L=b(c(F),2);y(()=>{r(l),ve(()=>{r(p)})}),_e(L,5,()=>r(p),ge,(e,a)=>{var o=Oe(),s=c(o,!0);d(o);var x={};y(()=>{D(s,r(a).title),x!==(x=r(a).id)&&(o.value=(o.__value=r(a).id)??"")}),k(e,o)}),d(L),d(F);var q=b(F,2),$=b(c(q),2);he($),d(q);var P=b(q,2);{var X=e=>{var a=Te(),o=c(a),s=c(o);d(o),d(a),y(()=>D(s,`‚ö†Ô∏è ${r(_)??""}`)),k(e,a)};E(P,e=>{r(_)&&e(X)})}var J=b(P,2);{var Y=e=>{var a=Fe(),o=c(a),s=c(o);d(o),d(a),y(()=>D(s,`‚úÖ ${r(h)??""}`)),k(e,a)};E(J,e=>{r(h)&&e(Y)})}var M=b(J,2),Z=c(M,!0);d(M),d(T),d(j),d(O),y(()=>{M.disabled=r(v)||!r(n)||!r(l),D(Z,r(v)?"Uploading...":"Upload Memory")}),A("change",N,H),A("drop",w,W),A("dragover",w,z),A("click",w,()=>{var e;return(e=document.getElementById("fileInput"))==null?void 0:e.click()}),Ae(L,()=>r(l),e=>i(l,e)),we($,()=>r(f),e=>i(f,e)),A("submit",T,ye(G)),k(t,O),pe()}export{Ce as component};
